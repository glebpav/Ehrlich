from typing import Dict, List

import numpy as np
from numpy import ndarray


def get_best_substitution(amino_acid: int, counter: ndarray) -> int:
    max_substitution = 0
    substitution_acid = -1
    for idx in range(len(amino_acid_list)):
        if counter[idx] > 0 and amin_similarity_matrix[amino_acid][idx] > max_substitution:
            max_substitution = amin_similarity_matrix[amino_acid][idx]
            substitution_acid = idx

    return substitution_acid


def get_amin_idx(amin: str) -> int:
    return amino_acid_list.index(amin.lower())


amino_acid_list: List[str] = ['ala',
                              'arg',
                              'asn',
                              'asp',
                              'cys',
                              'gln',
                              'glu',
                              'gly',
                              'his',
                              'ile',
                              'leu',
                              'lys',
                              'met',
                              'phe',
                              'pro',
                              'ser',
                              'thr',
                              'trp',
                              'tyr',
                              'val']

amin_similarity_matrix = np.array([[1., 0.22974729, 0.19218543, 0.00143939, 0.11967637,
                           0.77286402, 0.92944086, 0.65055965, 0.84255167, 0.05795329,
                           0.11300769, 0.15651196, 0.83090192, 0.55464044, 0.4787499,
                           0.71903735, 0.97202047, 0.55685271, 0.78936811, 0.78550925],
                          [0.60902233, 1., 0.44456201, 0.86090531, 0.84718847,
                           0.87502569, 0.33356478, 0.07919622, 0.29071761, 0.15771402,
                           0.42500787, 0.54748094, 0.70237049, 0.89253434, 0.03585938,
                           0.98538162, 0.61988284, 0.25695485, 0.2557573, 0.56113914],
                          [0.45374771, 0.27067703, 1., 0.29406383, 0.01494203,
                           0.56534199, 0.06367245, 0.83823613, 0.1479542, 0.15651895,
                           0.48651822, 0.82610956, 0.20923957, 0.33342134, 0.90000679,
                           0.90256852, 0.07055365, 0.36509184, 0.38772083, 0.89862662],
                          [0.93368129, 0.52417536, 0.92301837, 1., 0.4914575,
                           0.4730006, 0.14897061, 0.83908007, 0.31668023, 0.19205454,
                           0.81389471, 0.96138069, 0.90184748, 0.08902703, 0.18596659,
                           0.99683204, 0.9881233, 0.26464906, 0.71001881, 0.22530048],
                          [0.79697731, 0.11209438, 0.3616664, 0.61493295, 1.,
                           0.63888432, 0.533836, 0.04054772, 0.68939806, 0.97351915,
                           0.00448294, 0.76296889, 0.13252824, 0.89724996, 0.40279192,
                           0.38243368, 0.4906687, 0.19061384, 0.07433818, 0.65252493],
                          [0.45163621, 0.45589816, 0.36429128, 0.61418068, 0.48367144,
                           1., 0.31052486, 0.87037363, 0.47753781, 0.87243993,
                           0.79767599, 0.48206154, 0.01258291, 0.82676049, 0.72928817,
                           0.88668458, 0.98347782, 0.47660654, 0.31538491, 0.39596949],
                          [0.29892878, 0.43638438, 0.83023969, 0.01372109, 0.91097831,
                           0.52780728, 1., 0.20116682, 0.32446513, 0.42582841,
                           0.73470783, 0.6691732, 0.12497111, 0.17157106, 0.9811869,
                           0.5445402, 0.74738186, 0.46790264, 0.34176295, 0.0403945],
                          [0.04886969, 0.3148795, 0.31405352, 0.8776374, 0.65968226,
                           0.78261505, 0.25821787, 1., 0.36602367, 0.31858736,
                           0.01032737, 0.64267647, 0.11882943, 0.2985004, 0.59405749,
                           0.16177825, 0.62694919, 0.60055543, 0.93735866, 0.56478169],
                          [0.8689539, 0.3101805, 0.24241333, 0.48596318, 0.67478239,
                           0.75188065, 0.03446499, 0.82910532, 1., 0.90103594,
                           0.09137675, 0.23400627, 0.36283195, 0.45791173, 0.3147659,
                           0.98145797, 0.49899216, 0.75418783, 0.0188803, 0.81784137],
                          [0.85802328, 0.77142272, 0.88025605, 0.44409434, 0.24041132,
                           0.57167417, 0.45554609, 0.14757593, 0.68141473, 1.,
                           0.63065358, 0.42997072, 0.54252562, 0.53337233, 0.27571218,
                           0.3308921, 0.80899803, 0.56629457, 0.61316465, 0.51453137],
                          [0.94770486, 0.89244751, 0.72433472, 0.64162646, 0.38765976,
                           0.28044944, 0.48624718, 0.11114472, 0.88484399, 0.17680839,
                           1., 0.61114899, 0.50892676, 0.25234829, 0.65317009,
                           0.52943286, 0.02721318, 0.86547536, 0.09635069, 0.32892931],
                          [0.09838291, 0.12636144, 0.61125008, 0.71306877, 0.43134515,
                           0.73805392, 0.64132936, 0.82167392, 0.69324749, 0.83971695,
                           0.10896721, 1., 0.10300575, 0.32037202, 0.17685718,
                           0.8994424, 0.20703919, 0.02658253, 0.58915958, 0.54466552],
                          [0.10329286, 0.89088954, 0.75261558, 0.95887182, 0.6649627,
                           0.17683052, 0.39241013, 0.60160006, 0.2858354, 0.95125619,
                           0.99285439, 0.15733069, 1., 0.44573048, 0.49418921,
                           0.90250931, 0.2528197, 0.2218413, 0.17321253, 0.38403363],
                          [0.14663989, 0.61186531, 0.07590624, 0.12182402, 0.05448821,
                           0.214987, 0.88888423, 0.01684821, 0.34230414, 0.12949033,
                           0.89018189, 0.75525608, 0.86828058, 1., 0.12690969,
                           0.86955508, 0.34168282, 0.14082672, 0.28060434, 0.67777536],
                          [0.87544713, 0.31346014, 0.80532285, 0.11686933, 0.31719664,
                           0.6428406, 0.49824311, 0.17312211, 0.88646793, 0.75812469,
                           0.68563291, 0.60733597, 0.12304487, 0.76180978, 1.,
                           0.25992019, 0.35320575, 0.98919098, 0.83306851, 0.54371249],
                          [0.92226729, 0.71946959, 0.64980005, 0.77422074, 0.78461279,
                           0.24380035, 0.92212612, 0.78568156, 0.64248405, 0.05093826,
                           0.62914644, 0.46542521, 0.53448204, 0.20395246, 0.51107036,
                           1., 0.40704005, 0.8451925, 0.16674394, 0.13105962],
                          [0.19378779, 0.41434313, 0.26376441, 0.88879894, 0.39995274,
                           0.26807294, 0.63172587, 0.0303423, 0.00776104, 0.39048984,
                           0.10582755, 0.2926733, 0.76376251, 0.33239025, 0.85752571,
                           0.1459281, 1., 0.2116112, 0.99559403, 0.7643393],
                          [0.57258665, 0.11752784, 0.55888148, 0.57824008, 0.20951711,
                           0.91049746, 0.30589814, 0.35501842, 0.29165686, 0.14942977,
                           0.7228895, 0.21520199, 0.48257354, 0.75528683, 0.31264626,
                           0.82019784, 0.19703296, 1., 0.12553697, 0.37106106],
                          [0.8340605, 0.8766084, 0.0564471, 0.20442619, 0.93284956,
                           0.77336985, 0.88088322, 0.15581077, 0.61046607, 0.73940418,
                           0.97134224, 0.07041752, 0.27236865, 0.19482259, 0.26532488,
                           0.3803158, 0.66498448, 0.36956809, 1., 0.455744],
                          [0.99303231, 0.89536401, 0.7463364, 0.22679065, 0.34802991,
                           0.536388, 0.48565796, 0.02791739, 0.43874631, 0.74419062,
                           0.39426957, 0.24014405, 0.8533343, 0.96575382, 0.7906139,
                           0.73700443, 0.90072931, 0.84436488, 0.4254572, 1.]])
