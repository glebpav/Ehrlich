from typing import Dict, List

import numpy as np
from numpy import ndarray


def get_best_substitution(amino_acid: int, counter: ndarray) -> int:
    """
    Find the best substitution amino acid with given amino acid and segment counter.
    :return: best amin idx for substitution
    """
    max_substitution = 0
    substitution_acid = -1
    for idx in range(len(amino_acid_list)):
        if counter[idx] > 0 and amin_similarity_matrix[amino_acid][idx] > max_substitution:
            max_substitution = amin_similarity_matrix[amino_acid][idx]
            substitution_acid = idx

    return substitution_acid


def get_amin_idx(amin: str) -> int:
    """
    Get amin acid idx by its name
    :param amin: amin acid name
    :return: amin acid idx
    """
    return amino_acid_list.index(amin.lower())


amino_acid_list: List[str] = ['ala',
                              'arg',
                              'asn',
                              'asp',
                              'cys',
                              'gln',
                              'glu',
                              'gly',
                              'his',
                              'ile',
                              'leu',
                              'lys',
                              'met',
                              'phe',
                              'pro',
                              'ser',
                              'thr',
                              'trp',
                              'tyr',
                              'val']

amin_similarity_matrix = np.array(
    [[1., -0.49098315, 0.11547395, 0.27428213, 0.23763685, -0.23748957,
      0.15027267, 0.80822504, -0.57048888, 0.54320835, 0.2223599, -0.43311108,
      0.46941697, 0.2888967, 0.44673452, 0.20125532, 0.17229759, 0.23248456,
      0.40074939, 0.36921865],
     [-0.49098315, 1., -0.13530457, -0.46957544, -0.20474885, 0.4795304,
      -0.52321187, -0.45324041, 0.24284928, -0.08178412, -0.18411406, 0.58866299,
      -0.1624757, -0.01114611, -0.59870099, 0.12794847, 0.17529412, -0.05732784,
      -0.31654373, -0.12101791],
     [0.11547395, -0.13530457, 1., -0.59734673, 0.72064547, -0.13129918,
      -0.39615749, 0.38010404, 0.12241707, -0.08052928, 0.5859976, 0.28967435,
      0.1496603, 0.02873017, 0.20659264, 0.37166827, -0.35960166, 0.17912081,
      0.04787094, -0.01865895],
     [0.27428213, -0.46957544, -0.59734673, 1., -0.49458726, -0.02830301,
      0.81485984, 0.19278654, -0.55958325, 0.08603251, -0.27195532, -0.6128266,
      -0.04902906, -0.12185929, 0.34010596, -0.39891876, 0.42919715, -0.3912882,
      0.02152411, -0.08446529],
     [0.23763685, -0.20474885, 0.72064547, -0.49458726, 1., -0.28757176,
      -0.42370859, 0.46878427, 0.04685796, 0.03463294, 0.51529642, 0.21292878,
      0.10100691, 0.18163499, 0.19049618, 0.49723004, -0.29547686, 0.33604823,
      0.26588305, 0.03422389],
     [-0.23748957, 0.4795304, -0.13129918, -0.02830301, -0.28757176, 1.,
      -0.00217526, -0.27768166, -0.22206625, -0.01851715, -0.35706717, 0.06967678,
      -0.0432483, -0.21227496, 0.03006986, 0.14672214, 0.46423855, -0.37496604,
      -0.19510827, -0.17408933],
     [0.15027267, -0.52321187, -0.39615749, 0.81485984, -0.42370859, -0.00217526,
      1., 0.10559527, -0.46549903, -0.02921985, -0.25719852, -0.60323273,
      -0.11659713, -0.23704376, 0.26363916, -0.40188284, 0.16372143, -0.45590047,
      -0.14254806, -0.11827391],
     [0.80822504, -0.45324041, 0.38010404, 0.19278654, 0.46878427, -0.27768166,
      0.10559527, 1., -0.43338816, 0.13643246, 0.3487308, -0.12418753,
      0.0901111, 0.05062066, 0.27426083, 0.17523841, 0.2025993, 0.0296629,
      0.15475908, -0.05818623],
     [-0.57048888, 0.24284928, 0.12241707, -0.55958325, 0.04685796, -0.22206625,
      -0.46549903, -0.43338816, 1., -0.59389229, -0.22356703, 0.48059507,
      -0.51041737, -0.38215529, -0.57857412, 0.1090273, -0.42864033, -0.01307323,
      -0.42154356, -0.33892205, ],
     [0.54320835, -0.08178412, -0.08052928, 0.08603251, 0.03463294, -0.01851715,
      -0.02921985, 0.13643246, -0.59389229, 1., 0.27373565, -0.50260834,
      0.89105126, 0.63912281, 0.4426885, 0.23372842, 0.0641496, 0.36825368,
      0.55778153, 0.90705463],
     [0.2223599, -0.18411406, 0.5859976, -0.27195532, 0.51529642, -0.35706717,
      -0.25719852, 0.3487308, -0.22356703, 0.27373565, 1., 0.07610683,
      0.42196285, 0.50896311, 0.27387082, -0.04277907, -0.12419402, 0.35380278,
      0.29556432, 0.34046475],
     [-0.43311108, 0.58866299, 0.28967435, -0.6128266, 0.21292878, 0.06967678,
      -0.60323273, -0.12418753, 0.48059507, -0.50260834, 0.07610683, 1.,
      -0.40745579, -0.21525668, -0.70029129, -0.13634641, -0.17921674, 0.03555867,
      -0.32407505, -0.44038969],
     [0.46941697, -0.1624757, 0.1496603, -0.04902906, 0.10100691, -0.0432483,
      -0.11659713, 0.0901111, -0.51041737, 0.89105126, 0.42196285, -0.40745579,
      1., 0.59407882, 0.56096788, 0.15047451, -0.12733763, 0.50691607,
      0.62375528, 0.85855867],
     [0.2888967, -0.01114611, 0.02873017, -0.12185929, 0.18163499, -0.21227496,
      -0.23704376, 0.05062066, -0.38215529, 0.63912281, 0.50896311, -0.21525668,
      0.59407882, 1., 0.31822143, -0.04356127, -0.10649662, 0.67438841,
      0.77928427, 0.67076997],
     [0.44673452, -0.59870099, 0.20659264, 0.34010596, 0.19049618, 0.03006986,
      0.26363916, 0.27426083, -0.57857412, 0.4426885, 0.27387082, -0.70029129,
      0.56096788, 0.31822143, 1., 0.19913808, 0.11701634, 0.20386504,
      0.56200325, 0.351154],
     [0.20125532, 0.12794847, 0.37166827, -0.39891876, 0.49723004, 0.14672214,
      -0.40188284, 0.17523841, 0.1090273, 0.23372842, -0.04277907, -0.13634641,
      0.15047451, -0.04356127, 0.19913808, 1., 0.10617841, 0.03949094,
      -0.03544605, 0.14884887],
     [0.17229759, 0.17529412, -0.35960166, 0.42919715, -0.29547686, 0.46423855,
      0.16372143, 0.2025993, -0.42864033, 0.0641496, -0.12419402, -0.17921674,
      -0.12733763, -0.10649662, 0.11701634, 0.10617841, 1., -0.45026784,
      -0.1725373, -0.16254085],
     [0.23248456, -0.05732784, 0.17912081, -0.3912882, 0.33604823, -0.37496604,
      -0.45590047, 0.0296629, -0.01307323, 0.36825368, 0.35380278, 0.03555867,
      0.50691607, 0.67438841, 0.20386504, 0.03949094, -0.45026784, 1.,
      0.7623639, 0.48675456],
     [0.40074939, -0.31654373, 0.04787094, 0.02152411, 0.26588305, -0.19510827,
      -0.14254806, 0.15475908, -0.42154356, 0.55778153, 0.29556432, -0.32407505,
      0.62375528, 0.77928427, 0.56200325, -0.03544605, -0.1725373, 0.7623639,
      1., 0.58482086],
     [0.36921865, -0.12101791, -0.01865895, -0.08446529, 0.03422389, -0.17408933,
      -0.11827391, -0.05818623, -0.33892205, 0.90705463, 0.34046475, -0.44038969,
      0.85855867, 0.67076997, 0.351154, 0.14884887, -0.16254085, 0.48675456,
      0.58482086, 1.]]
)
